@using Final_Test_Hybrid.Models.Archive

<div class="tab-content">
    <RadzenDataGrid Data="@Data" TItem="ArchiveResultItem"
                AllowFiltering="false" AllowSorting="true"
                EmptyText="Нет данных">
    <Columns>
        <RadzenDataGridColumn TItem="ArchiveResultItem" Property="ParameterName" Title="Параметр" />
        <RadzenDataGridColumn TItem="ArchiveResultItem" Property="Value" Title="Значение" />
        @if (ShowRange)
        {
            <RadzenDataGridColumn TItem="ArchiveResultItem" Property="Min" Title="Мин" />
            <RadzenDataGridColumn TItem="ArchiveResultItem" Property="Max" Title="Макс" />
        }
        <RadzenDataGridColumn TItem="ArchiveResultItem" Property="Status" Title="Статус" Width="100px">
            <Template Context="item">
                @if (TryGetStatusView(item.Status, out var badgeStyle, out var statusText))
                {
                    <RadzenBadge class="archive-status-badge"
                                 Style="padding: 5px" BadgeStyle="@badgeStyle"
                                 Text="@statusText" />
                }
                else
                {
                    <span>-</span>
                }
            </Template>
        </RadzenDataGridColumn>
        <RadzenDataGridColumn TItem="ArchiveResultItem" Property="Unit" Title="Ед.изм." Width="100px" />
    </Columns>
    </RadzenDataGrid>
</div>

@code {
    [Parameter]
    public IReadOnlyList<ArchiveResultItem> Data { get; set; } = [];

    [Parameter]
    public bool ShowRange { get; set; } = true;

    private static bool TryGetStatusView(int? status, out BadgeStyle badgeStyle, out string statusText)
    {
        switch (status)
        {
            case 1:
                badgeStyle = BadgeStyle.Success;
                statusText = "OK";
                return true;
            case 2:
                badgeStyle = BadgeStyle.Danger;
                statusText = "NOK";
                return true;
            default:
                badgeStyle = BadgeStyle.Success;
                statusText = string.Empty;
                return false;
        }
    }
}
