@using Final_Test_Hybrid.Services.Main
@inject MessageService MessageService
@implements IDisposable

<div class="message-helper-container">
    <RadzenTextArea Value="@MessageService.CurrentMessage"
                    Rows="1"
                    ReadOnly="true" />
</div>

@code {
    private Action? _onChangeHandler;
    private bool _disposed;

    protected override void OnInitialized()
    {
        _onChangeHandler = () =>
        {
            if (_disposed) return;
            _ = InvokeAsync(StateHasChanged);
        };
        MessageService.OnChange += _onChangeHandler;
    }

    public void Dispose()
    {
        _disposed = true;
        if (_onChangeHandler != null)
        {
            MessageService.OnChange -= _onChangeHandler;
        }
    }
}
