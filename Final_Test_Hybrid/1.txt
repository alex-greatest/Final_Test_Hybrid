смотри дальше нам нужно внедрить систему повтора. давай начнём с состояние ок. 

 когда все шаг были ок. если всё ок, вот закончили мы тест @Final_Test_Hybrid/Services/Steps/Infrastructure/Execution/PreExecution/PreExecutionCoordinator.cs всё было ок _testResult = 1. 

нам надо записать общий сигнал end = true (ErrorSkip в BaseTags) в plc пишем только без паузы 


Сначала завершение теста:

1) Ожидаем end = false (его сбросит плк)
2) если end = false, то надо отправить данные в mes или в бд в зависимости от usemes. это делам пока заглушку.
3) если не получилось сохранить, то показываем уведомление от сервиса и отображаем диалоговое окно с кнопкой повтора, которая будет повторять запрос. показываем окно пока не получим ок или пока не произойдёт мягки или жёсткий сброс @Final_Test_Hybrid/PlcResetGuide.md.
4) всё получилось то делам сброс аналогичный мягкому или жёсктому (те же очистики и т.д. ну один в один крч).


Повтор теста:


1) Ожидаем end = false (его сбросит плк) и если появился Req_Repeat = true читаем из плк, то нам надо записать Ask_repeat = true в плк.
2) Ask_Repeat сбросит Req_Repeat=false и End = false и тогда надо очистить только грид, кроме шага сканирования.  очистить время шагов кроме сканирования
очистить все результаты и истории ошибок. и по сути запустить тест заново (минуя скан).



Изображение


1) когда мы начинаем процесс ожидания повтора или полного завершения теста (получили в PreExecutionCoordinator testReuslt =1). мы  в компоненте @Final_Test_Hybrid/MyComponent.razor прям вместо грида и тексовтого поля @Final_Test_Hybrid/Services/Main/Messages/MessageService.cs показать
  @Final_Test_Hybrid/wwwroot/images/green_smiley_clean.png 

2) поверх картинки вверху её надо показать текст: ""Один шаг" - закончить тест или "Повтор" (чёрного цвета, жирным) для повтора теста".

3) если вдруг случится мягки или жёский сброс (то есть не ждём ask end, а именно когда поняли что начинатеся сброс) картинку убираем и показываем грид и поле.

4) когда повторили или закончили тест, то надо скрыть изображение и вернуть грид и текстовое поле. D:\projects\Final_Test_Hybrid\Final_Test_Hybrid\Screenshot_3.png пример когда есть изображение.


понятно test_result = 2. так же пишме end = true (ErrorSkip в BaseTags).  показываем изображение. должно быть грустное, но пока ставь это же

 
Повтор теста при NOK:

1) абсолютно те же условия. тут надо сохранить в mes или бд.
2) но при nok. надо сделать все дейтсвия из шага сканирования (неважно mes или не mes), кроме самого сканирования. то есть получения типа, рецептов, загрузка построение map. для бд (без mes). 
3) если какое-то сбой так же показываем окно с повторить и повторяем (то есть окно не закрываем, в окне просто текст, не удалось повторить тест, а в уведомление сообщение от сервиса) пока не получим ок, закрыть так же через мягкий или жётски сброс. Для mes, если неизвестная ошибка тоже самое. или rework flow. тот же что есть. соотвественно messageservice обновлятеся. 
4) когда получилось: ask_Repeat сбросит Req_Repeat=false и End = false и тогда надо очистить только грид, кроме шага сканирования.  очистить время шагов кроме сканирования очистить все результаты и истории ошибок. показываем грид (скрываем изображение) и переходим к следующем шагу после скана.


Пропуска теста для NOK тоже самое что и при ок...